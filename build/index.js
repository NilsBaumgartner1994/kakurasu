module.exports=(()=>{var t={10:t=>{class e{constructor(t={}){this.state={},this.state.moveHistory=t.moveHistory||[],this.state.currentMoveIndex=t.currentMoveIndex||null,!this.state.currentMoveIndex&&this.state.moveHistory.length>0&&(this.state.currentMoveIndex=this.state.moveHistory.length-1),t.fields||(t.fields=o.generateLevel()),this.state.fields={};let e=Object.keys(t.fields);for(let o=0;o<e.length;o++){let s=e[o],i=t.fields[s];this.state.fields[s]=new n(i)}this._loadFieldMetaInformations()}getAmountMoves(){return this.state.moveHistory.length}changeActiveStatus(t,e){let n=this.getField(t,e).isClear()?STATUS_ACTIVE:STATUS_CLEAR;return this._setFieldStatus(t,e,n)}changeFlagStatus(t,e){let n=this.getField(t,e).isClear()?STATUS_FLAGGED:STATUS_CLEAR;return this._setFieldStatus(t,e,n)}_setFieldStatus(t,e,n){let o={row:t,column:e,status:n};return this._makeMove(o)}_makeMove(t){let e=this._applyMove(t);return e&&this._addMoveToHistory(t),e}_addMoveToHistory(t){this._deleteFutureMoveHistory(),this.state.moveHistory.push(t),this._changeCurrentMoveIndex(1)}_deleteFutureMoveHistory(t){let e=this.state.currentMoveIndex;e&&(this.state.moveHistory=this.state.moveHistory.slice(0,e))}_changeCurrentMoveIndex(t){this.state.currentMoveIndex=this.state.currentMoveIndex+t,this.state.currentMoveIndex<0&&(this.state.currentMoveIndex=null)}_applyMove(t){let e=this.getField(t.row,t.column);return!!e.isEditable()&&(e.setStatus(t.status),!0)}getField(t,n){let o=e._getFieldKey(t,n),s=this.state.fields[o];return s.row=t,s.column=n,s}static _getFieldKey(t,e){return t+"-"+e}redoMove(){if(null!==this.state.currentMoveIndex){let t=JSON.parse(JSON.stringify(this.state.moveHistory[this.state.currentMoveIndex+1]));if(t)return this._changeCurrentMoveIndex(1),this._applyMove(t)}return!1}undoMove(){if(null!==this.state.currentMoveIndex){let t=JSON.parse(JSON.stringify(this.state.moveHistory[this.state.currentMoveIndex]));if(t)return t.enabled=!t.enabled,this._changeCurrentMoveIndex(-1),this._applyMove(t)}return!1}asJSON(){let t=e._fieldsAsJSON(this.state.fields),n=JSON.parse(JSON.stringify(this.state));return n.fields=t,n}static _fieldsAsJSON(t){let e={},n=Object.keys(t);for(let o=0;o<n.length;o++){let s=n[o],i=t[s];e[s]=i.asJSON()}return e}isGameWon(){let t=this._areAllRowColumnContraintsSatisfied(!0);if(!t)return!1;let e=this._areAllRowColumnContraintsSatisfied(!1);return!!e&&t&&e}_areAllRowColumnContraintsSatisfied(t=!1){let e=this._getAmountRowColumns(t);for(let t=0;t<e;t++)if(!this._isRowColumnConstraintSatisfied(!0,t))return!1;return!0}_getAmountRowColumns(t){return t?this.getAmountRows():this.getAmountColumns()}_isRowColumnConstraintSatisfied(t,e){return this._getConstraintValue(t,e)===this._getRowColumnSumValue(t,e)}_getRowColumnSumValue(t=!1,e){let n=this._getFieldsInRowColumn(t,e),o=0;for(let e=0;e<n.length;e++){let s=n[e],i=this._getWeightForField(t,s);s.isActive()&&(o+=i)}return o}_loadFieldMetaInformations(){this.meta={},this._loadFiledMetaInformationsAmountRowsAndColumns(),this._loadFieldMetaInformationsContraints()}_loadFiledMetaInformationsAmountRowsAndColumns(){let t=this.state.fields,e=Object.keys(t),n=null,o=null;for(let t=0;t<e.length;t++){let s=e[t].split("-"),i=parseInt(s[0]),r=parseInt(s[1]);(!o||o<i)&&(o=i),(!n||n<i)&&(n=r)}this.meta.amountRows=null!==n?n+1:0,this.meta.amountColumns=null!==o?o+1:0}_loadFieldMetaInformationsContraints(){this.meta.contraints={},this.meta.contraints[this._getConstraintRowOrColumn(!0)]={},this.meta.contraints[this._getConstraintRowOrColumn(!1)]={},this._loadFieldMetaInformationsConstraintsForRowColumn(!0),this._loadFieldMetaInformationsConstraintsForRowColumn(!1)}_loadFieldMetaInformationsConstraintsForRowColumn(t=!1){let e=t?this.getAmountRows():this.getAmountColumns();for(let n=0;n<e;n++)this._loadFieldMetaInformationsContraintsForFields(t,n)}getWeight(t){return t+1}getFieldsInRow(t){return this._getFieldsInRowColumn(!0,t)}getFieldsInColumn(t){return this._getFieldsInRowColumn(!1,t)}_getFieldsInRowColumn(t,e){let n=[],o=this._getAmountRowColumns(t);for(let s=0;s<o;s++){let o=t?e:s,i=t?s:e,r=this.getField(o,i);n.push(r)}return n}_getWeightForField(t=!1,e){let n=t?e.column:e.row;return this.getWeight(n)}_loadFieldMetaInformationsContraintsForFields(t=!1,e){let n=this._getFieldsInRowColumn(t,e),o=0;for(let e=0;e<n.length;e++){let s=n[e],i=this._getWeightForField(t,s);s.isSolution()&&(o+=i)}let s=this._getConstraintRowOrColumn(t);this.meta.contraints[s][e]=o}getConstraintValueForRow(t){return this._getConstraintValue(!0,t)}getConstraintValueForColumn(t){return this._getConstraintValue(!1,t)}_getConstraintValue(t=!1,e){let n=this._getConstraintRowOrColumn(t);return this.meta.contraints[n][e]}_getConstraintRowOrColumn(t){return t?"rows":"columns"}getAmountRows(){return this.meta.amountRows}getAmountColumns(){return this.meta.amountColumns}getHighestConstraintValue(){let t=this.getHighestConstraintForColumnRow(!0),e=this.getHighestConstraintForColumnRow(!1);return t>e?t:e}getHighestConstraintForColumnRow(t){let e=this._getAmountRowColumns(t),n=null;for(let o=0;o<e;o++){let e=t?this.getConstraintValueForRow(o):this.getConstraintValueForColumn(o);(null===n||n<e)&&(n=e)}return n}print(){let t=this.getAmountRows(),e=this.getAmountColumns(),n=t>e?(t+"").length:(e+"").length,o=(this.getHighestConstraintValue()+"").length,s=n>o?n:o,i="".padStart(s," ")+"|";for(let t=0;t<e;t++)i+=(this.getWeight(t)+"").padStart(s," ")+"|";i+="".padStart(s," ")+"\n";for(let n=0;n<t;n++){i+="".padStart(s,"-")+"+";for(let t=0;t<e;t++)i+="".padStart(s,"-")+"+";i+="".padStart(s,"-")+"\n",i+=(this.getWeight(n)+"").padStart(s," ")+"|";for(let t=0;t<e;t++)i+=(this.getField(n,t).isSolution()?"X":"").padStart(s," ")+"|";i+=(this.getConstraintValueForRow(n)+"").padStart(s," ")+"\n"}i+="".padStart(s,"-")+"+";for(let t=0;t<e;t++)i+="".padStart(s,"-")+"+";i+="".padStart(s,"-")+"\n",i+="".padStart(s," ")+"|";for(let t=0;t<e;t++)i+=(this.getConstraintValueForColumn(t)+"").padStart(s," ")+"|";return i}}STATUS_CLEAR=0,STATUS_ACTIVE=1,STATUS_FLAGGED=2;class n{constructor(t={status:STATUS_CLEAR}){this.state=t}setStatus(t){this.state.status=t}isClear(){return this.state.status===STATUS_CLEAR}isActive(){return this.state.status===STATUS_ACTIVE}isFlagged(){return this.state.status===STATUS_FLAGGED}setEditable(t){this.state.editable=t}isEditable(){return this.state.editable}setIsSolution(t){this.state.solution=t}isSolution(){return this.state.solution}getState(){return this.state}asJSON(){return this.getState()}}class o{static generateLevel(t){(t=t||{}).rows=t.rows||5,t.columns=t.columns||t.rows,t.difficulty=t.difficulty||"medium",t.amountMinimumInRow=t.amountMinimumInRow||1,t.amountMaximumInRow=t.amountMaximumInRow||t.rows/2,t.amountMinimumInColumn=t.amountMinimumInColumn||1,t.amountMaximumInColumn=t.amountMaximumInColumn||t.columns/2,t.amountMinimumInRow<0&&(t.amountMinimumInRow=0),t.amountMinimumInRow>t.rows&&(t.amountMinimumInRow=t.rows),t.amountMaximumInRow>t.rows&&(t.amountMaximumInRow=t.rows),t.amountMaximumInRow<0&&(t.amountMaximumInRow=0),t.amountMaximumInRow<t.amountMinimumInRow&&(t.amountMaximumInRow=t.amountMinimumInRow),t.amountMinimumInColumn<0&&(t.amountMinimumInColumn=0),t.amountMinimumInColumn>t.columns&&(t.amountMinimumInColumn=t.columns),t.amountMaximumInColumn>t.columns&&(t.amountMaximumInColumn=t.columns),t.amountMaximumInColumn<0&&(t.amountMaximumInColumn=0),t.amountMaximumInColumn<t.amountMinimumInColumn&&(t.amountMaximumInColumn=t.amountMinimumInColumn);let n=o._initEmptyField(t.rows,t.columns);return n=o._setSolutionFieldsForRowColumn(!0,n,t),n=o._setSolutionFieldsForRowColumn(!1,n,t),e._fieldsAsJSON(n)}static _setSolutionFieldsForRowColumn(t,n,s){let i=t?s.rows:s.columns;for(let r=0;r<i;r++){let i=[];i=t?o._selectRandomAmountIndexes(s.columns,s.amountMinimumInColumn,s.amountMaximumInColumn):o._selectRandomAmountIndexes(s.rows,s.amountMinimumInRow,s.amountMaximumInRow);for(let o=0;o<i.length;o++){let s=i[o],a=t?r:s,u=t?s:r,l=e._getFieldKey(a,u),m=n[l];m.setIsSolution(!0),n[l]=m}}return n}static _initEmptyField(t,o){let s={};for(let i=0;i<t;i++){let t=i;for(let i=0;i<o;i++){let o=i;s[e._getFieldKey(t,o)]=new n}}return s}static _selectRandomAmountIndexes(t,e,n){let s=o._getRandomInt(e,n),i=Array.from(Array(t).keys()),r=o._shuffle(i),a=[];for(let t=0;t<s;t++)a.push(r[t]);return a}static _getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}static _shuffle(t){var e,n,o;for(o=t.length-1;o>0;o--)e=Math.floor(Math.random()*(o+1)),n=t[o],t[o]=t[e],t[e]=n;return t}}t.exports.Kakurasu=e,t.exports.KakurasuField=n,t.exports.KakurasuLevelGenerator=o}},e={};return function n(o){if(e[o])return e[o].exports;var s=e[o]={exports:{}};return t[o](s,s.exports,n),s.exports}(10)})();