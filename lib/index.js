module.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.state={},this.state.moveHistory=e.moveHistory||[],this.state.currentMoveIndex=e.currentMoveIndex||null,!this.state.currentMoveIndex&&this.state.moveHistory.length>0&&(this.state.currentMoveIndex=this.state.moveHistory.length-1),e.fields||(e.fields=a.generateLevel()),this.state.fields={};for(var n=Object.keys(e.fields),o=0;o<n.length;o++){var u=n[o],s=e.fields[u];this.state.fields[u]=new r(s)}this._loadFieldMetaInformations()}return o(t,[{key:"getAmountMoves",value:function(){return this.state.moveHistory.length}},{key:"setFieldActive",value:function(t,e){return this._setFieldStatus(t,e,1)}},{key:"setFieldFlagged",value:function(t,e){return this._setFieldStatus(t,e,2)}},{key:"setFieldClear",value:function(t,e){return this._setFieldStatus(t,e,0)}},{key:"changeActiveStatus",value:function(t,e){return this.getField(t,e).isClear()?this.setFieldActive(t,e):this.setFieldClear(t,e)}},{key:"changeFlagStatus",value:function(t,e){return this.getField(t,e).isClear()?this.setFieldFlagged(t,e):this.setFieldClear(t,e)}},{key:"_setFieldStatus",value:function(t,e,n){var o={row:t,column:e,previousStatus:this.getField(t,e).getStatus(),nextStatus:n};return this._makeMove(o)}},{key:"_makeMove",value:function(t){var e=this._applyMove(t);return e&&this._addMoveToHistory(t),e}},{key:"_addMoveToHistory",value:function(t){this._deleteFutureMoveHistory(),this.state.moveHistory.push(t),this._changeCurrentMoveIndex(1)}},{key:"_deleteFutureMoveHistory",value:function(){var t=this.state.currentMoveIndex;if(isNaN(parseInt(t)))this.state.moveHistory=[];else{var e;e=this.state.moveHistory.slice(0,t+1),this.state.moveHistory=e}}},{key:"_changeCurrentMoveIndex",value:function(t){this.state.currentMoveIndex=this._calcNextCurrentMoveIndex(t)}},{key:"_calcNextCurrentMoveIndex",value:function(t){var e=this.state.currentMoveIndex;return isNaN(parseInt(e))?t>0&&(e=0,(t-=1)>0&&(e=t)):(e+=t)<0&&(e=null),e}},{key:"_getFieldFromMove",value:function(t){return this.getField(t.row,t.column)}},{key:"_applyMove",value:function(t){var e=this._getFieldFromMove(t);return!e.isReadOnly()&&(e.setStatus(t.nextStatus),!0)}},{key:"getField",value:function(e,n){var o=t._getFieldKey(e,n),i=this.state.fields[o];return i.row=e,i.column=n,i}},{key:"getFieldOfCurrentMove",value:function(){var t=this.getMoveFromHistoryAsCopy(this._calcNextCurrentMoveIndex(0));return t?this._getFieldFromMove(t):null}},{key:"isPossibleToRedoMove",value:function(){return!!this.getMoveFromHistoryAsCopy(this._calcNextCurrentMoveIndex(1))}},{key:"redoMove",value:function(){if(this.isPossibleToRedoMove()){var t=this.getMoveFromHistoryAsCopy(this._calcNextCurrentMoveIndex(1));return this._changeCurrentMoveIndex(1),this._applyMove(t)}return!1}},{key:"getMoveFromHistoryAsCopy",value:function(t){var e=this.state.moveHistory[t];return e&&(e=JSON.parse(JSON.stringify(e))),e}},{key:"isPossibleToUndoMove",value:function(){return!!this.getMoveFromHistoryAsCopy(this._calcNextCurrentMoveIndex(0))}},{key:"undoMove",value:function(){if(this.isPossibleToUndoMove()){var t=this.getMoveFromHistoryAsCopy(this._calcNextCurrentMoveIndex(0)),e=t.nextStatus;return t.nextStatus=t.previousStatus,t.previousStatus=e,this._changeCurrentMoveIndex(-1),this._applyMove(t)}return!1}},{key:"asJSON",value:function(){var e=t._fieldsAsJSON(this.state.fields),n=JSON.parse(JSON.stringify(this.state));return n.fields=e,n}},{key:"isGameWon",value:function(){var t=this._areAllRowColumnContraintsSatisfied(!0);if(!t)return!1;var e=this._areAllRowColumnContraintsSatisfied(!1);return!!e&&(t&&e)}},{key:"_areAllRowColumnContraintsSatisfied",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._getAmountRowColumns(t),n=0;n<e;n++){var o=this._isRowColumnConstraintSatisfied(!0,n);if(!o)return!1}return!0}},{key:"_getAmountRowColumns",value:function(t){return t?this.getAmountRows():this.getAmountColumns()}},{key:"isRowConstraintSatisfied",value:function(t){return this._isRowColumnConstraintSatisfied(!0,t)}},{key:"isColumnConstraintSatisfied",value:function(t){return this._isRowColumnConstraintSatisfied(!1,t)}},{key:"_isRowColumnConstraintSatisfied",value:function(t,e){return this._getConstraintValue(t,e)===this._getRowColumnSumValue(t,e)}},{key:"_getRowColumnSumValue",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments[1],n=this._getFieldsInRowColumn(t,e),o=0,i=0;i<n.length;i++){var u=n[i],r=this._getWeightForField(t,u);u.isActive()&&(o+=r)}return o}},{key:"_loadFieldMetaInformations",value:function(){this.meta={},this._loadFiledMetaInformationsAmountRowsAndColumns(),this._loadFieldMetaInformationsContraints()}},{key:"_loadFiledMetaInformationsAmountRowsAndColumns",value:function(){for(var t=this.state.fields,e=Object.keys(t),n=null,o=null,i=0;i<e.length;i++){var u=e[i].split("-"),r=parseInt(u[0]),a=parseInt(u[1]);(!o||o<r)&&(o=r),(!n||n<r)&&(n=a)}this.meta.amountRows=null!==n?n+1:0,this.meta.amountColumns=null!==o?o+1:0}},{key:"_loadFieldMetaInformationsContraints",value:function(){this.meta.contraints={},this.meta.contraints[this._getConstraintRowOrColumn(!0)]={},this.meta.contraints[this._getConstraintRowOrColumn(!1)]={},this._loadFieldMetaInformationsConstraintsForRowColumn(!0),this._loadFieldMetaInformationsConstraintsForRowColumn(!1)}},{key:"_loadFieldMetaInformationsConstraintsForRowColumn",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t?this.getAmountRows():this.getAmountColumns(),n=0;n<e;n++)this._loadFieldMetaInformationsContraintsForFields(t,n)}},{key:"getWeight",value:function(t){return t+1}},{key:"getFieldsInRow",value:function(t){return this._getFieldsInRowColumn(!0,t)}},{key:"getFieldsInColumn",value:function(t){return this._getFieldsInRowColumn(!1,t)}},{key:"_getFieldsInRowColumn",value:function(t,e){for(var n=[],o=this._getAmountRowColumns(t),i=0;i<o;i++){var u=t?e:i,r=t?i:e,a=this.getField(u,r);n.push(a)}return n}},{key:"_getWeightForField",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments[1],n=t?e.column:e.row;return this.getWeight(n)}},{key:"_loadFieldMetaInformationsContraintsForFields",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments[1],n=this._getFieldsInRowColumn(t,e),o=0,i=0;i<n.length;i++){var u=n[i],r=this._getWeightForField(t,u),a=u.isSolution();a&&(o+=r)}var s=this._getConstraintRowOrColumn(t);this.meta.contraints[s][e]=o}},{key:"getConstraintValueForRow",value:function(t){return this._getConstraintValue(!0,t)}},{key:"getConstraintValueForColumn",value:function(t){return this._getConstraintValue(!1,t)}},{key:"_getConstraintValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments[1],n=this._getConstraintRowOrColumn(t);return this.meta.contraints[n][e]}},{key:"_getConstraintRowOrColumn",value:function(t){return t?"rows":"columns"}},{key:"getAmountRows",value:function(){return this.meta.amountRows}},{key:"getAmountColumns",value:function(){return this.meta.amountColumns}},{key:"getHighestConstraintValue",value:function(){var t=this.getHighestConstraintForColumnRow(!0),e=this.getHighestConstraintForColumnRow(!1);return t>e?t:e}},{key:"getHighestConstraintForColumnRow",value:function(t){for(var e=this._getAmountRowColumns(t),n=null,o=0;o<e;o++){var i=t?this.getConstraintValueForRow(o):this.getConstraintValueForColumn(o);(null===n||n<i)&&(n=i)}return n}},{key:"print",value:function(){for(var t=this.getAmountRows(),e=this.getAmountColumns(),n=t>e?(t+"").length:(e+"").length,o=(this.getHighestConstraintValue()+"").length,i=n>o?n:o,u="".padStart(i," ")+"|",r=0;r<e;r++)u+=(this.getWeight(r)+"").padStart(i," ")+"|";u+="".padStart(i," ")+"\n";for(var a=0;a<t;a++){u+="".padStart(i,"-")+"+";for(var s=0;s<e;s++)u+="".padStart(i,"-")+"+";u+="".padStart(i,"-")+"\n",u+=(this.getWeight(a)+"").padStart(i," ")+"|";for(var l=0;l<e;l++){var m=this.getField(a,l),v=(m.isSolution(),"");m.isActive()&&(v="A"),m.isFlagged()&&(v="x"),u+=v.padStart(i," ")+"|"}u+=(this.getConstraintValueForRow(a)+"").padStart(i," ")+"\n"}u+="".padStart(i,"-")+"+";for(var d=0;d<e;d++)u+="".padStart(i,"-")+"+";u+="".padStart(i,"-")+"\n",u+="".padStart(i," ")+"|";for(var f=0;f<e;f++)u+=(this.getConstraintValueForColumn(f)+"").padStart(i," ")+"|";return u}}],[{key:"_getFieldKey",value:function(t,e){return t+"-"+e}},{key:"_fieldsAsJSON",value:function(t){for(var e={},n=Object.keys(t),o=0;o<n.length;o++){var i=n[o],u=t[i];e[i]=u.asJSON()}return e}}]),t}(),r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:0};i(this,t),this.state=e}return o(t,[{key:"setStatus",value:function(t){this.state.status=t}},{key:"getStatus",value:function(){return this.state.status}},{key:"isClear",value:function(){return 0===this.state.status}},{key:"isActive",value:function(){return 1===this.state.status}},{key:"isFlagged",value:function(){return 2===this.state.status}},{key:"setReadOnly",value:function(t){t?this.state.readOnly=!0:delete this.state.readOnly}},{key:"isReadOnly",value:function(){return!!this.state.readOnly}},{key:"setIsSolution",value:function(t){this.state.solution=t}},{key:"isSolution",value:function(){return this.state.solution}},{key:"getState",value:function(){return this.state}},{key:"asJSON",value:function(){return this.getState()}}]),t}(),a=function(){function t(){i(this,t)}return o(t,null,[{key:"generateLevel",value:function(e){(e=e||{}).rows=e.rows||5,e.columns=e.columns||e.rows,e.difficulty=e.difficulty||"medium",e.amountMinimumInRow=e.amountMinimumInRow||1,e.amountMaximumInRow=e.amountMaximumInRow||e.rows/2,e.amountMinimumInColumn=e.amountMinimumInColumn||1,e.amountMaximumInColumn=e.amountMaximumInColumn||e.columns/2,e.amountMinimumInRow<0&&(e.amountMinimumInRow=0),e.amountMinimumInRow>e.rows&&(e.amountMinimumInRow=e.rows),e.amountMaximumInRow>e.rows&&(e.amountMaximumInRow=e.rows),e.amountMaximumInRow<0&&(e.amountMaximumInRow=0),e.amountMaximumInRow<e.amountMinimumInRow&&(e.amountMaximumInRow=e.amountMinimumInRow),e.amountMinimumInColumn<0&&(e.amountMinimumInColumn=0),e.amountMinimumInColumn>e.columns&&(e.amountMinimumInColumn=e.columns),e.amountMaximumInColumn>e.columns&&(e.amountMaximumInColumn=e.columns),e.amountMaximumInColumn<0&&(e.amountMaximumInColumn=0),e.amountMaximumInColumn<e.amountMinimumInColumn&&(e.amountMaximumInColumn=e.amountMinimumInColumn);var n=t._initEmptyField(e.rows,e.columns);return n=t._setSolutionFieldsForRowColumn(!0,n,e),n=t._setSolutionFieldsForRowColumn(!1,n,e),u._fieldsAsJSON(n)}},{key:"_setSolutionFieldsForRowColumn",value:function(e,n,o){for(var i=e?o.rows:o.columns,r=0;r<i;r++){var a=[];a=e?t._selectRandomAmountIndexes(o.columns,o.amountMinimumInColumn,o.amountMaximumInColumn):t._selectRandomAmountIndexes(o.rows,o.amountMinimumInRow,o.amountMaximumInRow);for(var s=0;s<a.length;s++){var l=a[s],m=e?r:l,v=e?l:r,d=u._getFieldKey(m,v),f=n[d];f.setIsSolution(!0),n[d]=f}}return n}},{key:"_initEmptyField",value:function(t,e){for(var n={},o=0;o<t;o++)for(var i=o,a=0;a<e;a++){var s=a;n[u._getFieldKey(i,s)]=new r}return n}},{key:"_selectRandomAmountIndexes",value:function(e,n,o){for(var i=t._getRandomInt(n,o),u=Array.from(Array(e).keys()),r=t._shuffle(u),a=[],s=0;s<i;s++)a.push(r[s]);return a}},{key:"_getRandomInt",value:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}},{key:"_shuffle",value:function(t){var e,n,o;for(o=t.length-1;o>0;o--)e=Math.floor(Math.random()*(o+1)),n=t[o],t[o]=t[e],t[e]=n;return t}}]),t}();t.exports.Kakurasu=u,t.exports.KakurasuField=r,t.exports.KakurasuLevelGenerator=a}]);