module.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(n,e,o){return e&&t(n.prototype,e),o&&t(n,o),n}}();function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var u=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.state={},this.state.moveHistory=n.moveHistory||[],this.state.currentMoveIndex=n.currentMoveIndex||null,!this.state.currentMoveIndex&&this.state.moveHistory.length>0&&(this.state.currentMoveIndex=this.state.moveHistory.length-1),n.fields||(n.fields=r.generateLevel()),this.state.fields={};for(var e=Object.keys(n.fields),o=0;o<e.length;o++){var u=e[o],s=n.fields[u];this.state.fields[u]=new a(s)}this._loadFieldMetaInformations()}return o(t,[{key:"getAmountMoves",value:function(){return this.state.moveHistory.length}},{key:"changeActiveStatus",value:function(t,n){var e=this.getField(t,n).isClear()?1:0;return this._setFieldStatus(t,n,e)}},{key:"changeFlagStatus",value:function(t,n){var e=this.getField(t,n).isClear()?2:0;return this._setFieldStatus(t,n,e)}},{key:"_setFieldStatus",value:function(t,n,e){var o={row:t,column:n,status:e};return this._makeMove(o)}},{key:"_makeMove",value:function(t){var n=this._applyMove(t);return n&&this._addMoveToHistory(t),n}},{key:"_addMoveToHistory",value:function(t){this._deleteFutureMoveHistory(),this.state.moveHistory.push(t),this._changeCurrentMoveIndex(1)}},{key:"_deleteFutureMoveHistory",value:function(t){var n=this.state.currentMoveIndex;n&&(this.state.moveHistory=this.state.moveHistory.slice(0,n))}},{key:"_changeCurrentMoveIndex",value:function(t){this.state.currentMoveIndex=this.state.currentMoveIndex+t,this.state.currentMoveIndex<0&&(this.state.currentMoveIndex=null)}},{key:"_applyMove",value:function(t){var n=this.getField(t.row,t.column);return!n.isReadOnly()&&(n.setStatus(t.status),!0)}},{key:"getField",value:function(n,e){var o=t._getFieldKey(n,e),i=this.state.fields[o];return i.row=n,i.column=e,i}},{key:"redoMove",value:function(){if(null!==this.state.currentMoveIndex){var t=JSON.parse(JSON.stringify(this.state.moveHistory[this.state.currentMoveIndex+1]));if(t)return this._changeCurrentMoveIndex(1),this._applyMove(t)}return!1}},{key:"undoMove",value:function(){if(null!==this.state.currentMoveIndex){var t=JSON.parse(JSON.stringify(this.state.moveHistory[this.state.currentMoveIndex]));if(t)return t.enabled=!t.enabled,this._changeCurrentMoveIndex(-1),this._applyMove(t)}return!1}},{key:"asJSON",value:function(){var n=t._fieldsAsJSON(this.state.fields),e=JSON.parse(JSON.stringify(this.state));return e.fields=n,e}},{key:"isGameWon",value:function(){var t=this._areAllRowColumnContraintsSatisfied(!0);if(!t)return!1;var n=this._areAllRowColumnContraintsSatisfied(!1);return!!n&&(t&&n)}},{key:"_areAllRowColumnContraintsSatisfied",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this._getAmountRowColumns(t),e=0;e<n;e++){var o=this._isRowColumnConstraintSatisfied(!0,e);if(!o)return!1}return!0}},{key:"_getAmountRowColumns",value:function(t){return t?this.getAmountRows():this.getAmountColumns()}},{key:"isRowConstraintSatisfied",value:function(t){return this._isRowColumnConstraintSatisfied(!0,t)}},{key:"isColumnConstraintSatisfied",value:function(t){return this._isRowColumnConstraintSatisfied(!1,t)}},{key:"_isRowColumnConstraintSatisfied",value:function(t,n){return this._getConstraintValue(t,n)===this._getRowColumnSumValue(t,n)}},{key:"_isRowColumnConstraintSatisfied",value:function(t,n){return this._getConstraintValue(t,n)===this._getRowColumnSumValue(t,n)}},{key:"_getRowColumnSumValue",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments[1],e=this._getFieldsInRowColumn(t,n),o=0,i=0;i<e.length;i++){var u=e[i],a=this._getWeightForField(t,u);u.isActive()&&(o+=a)}return o}},{key:"_loadFieldMetaInformations",value:function(){this.meta={},this._loadFiledMetaInformationsAmountRowsAndColumns(),this._loadFieldMetaInformationsContraints()}},{key:"_loadFiledMetaInformationsAmountRowsAndColumns",value:function(){for(var t=this.state.fields,n=Object.keys(t),e=null,o=null,i=0;i<n.length;i++){var u=n[i].split("-"),a=parseInt(u[0]),r=parseInt(u[1]);(!o||o<a)&&(o=a),(!e||e<a)&&(e=r)}this.meta.amountRows=null!==e?e+1:0,this.meta.amountColumns=null!==o?o+1:0}},{key:"_loadFieldMetaInformationsContraints",value:function(){this.meta.contraints={},this.meta.contraints[this._getConstraintRowOrColumn(!0)]={},this.meta.contraints[this._getConstraintRowOrColumn(!1)]={},this._loadFieldMetaInformationsConstraintsForRowColumn(!0),this._loadFieldMetaInformationsConstraintsForRowColumn(!1)}},{key:"_loadFieldMetaInformationsConstraintsForRowColumn",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t?this.getAmountRows():this.getAmountColumns(),e=0;e<n;e++)this._loadFieldMetaInformationsContraintsForFields(t,e)}},{key:"getWeight",value:function(t){return t+1}},{key:"getFieldsInRow",value:function(t){return this._getFieldsInRowColumn(!0,t)}},{key:"getFieldsInColumn",value:function(t){return this._getFieldsInRowColumn(!1,t)}},{key:"_getFieldsInRowColumn",value:function(t,n){for(var e=[],o=this._getAmountRowColumns(t),i=0;i<o;i++){var u=t?n:i,a=t?i:n,r=this.getField(u,a);e.push(r)}return e}},{key:"_getWeightForField",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments[1],e=t?n.column:n.row;return this.getWeight(e)}},{key:"_loadFieldMetaInformationsContraintsForFields",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments[1],e=this._getFieldsInRowColumn(t,n),o=0,i=0;i<e.length;i++){var u=e[i],a=this._getWeightForField(t,u),r=u.isSolution();r&&(o+=a)}var s=this._getConstraintRowOrColumn(t);this.meta.contraints[s][n]=o}},{key:"getConstraintValueForRow",value:function(t){return this._getConstraintValue(!0,t)}},{key:"getConstraintValueForColumn",value:function(t){return this._getConstraintValue(!1,t)}},{key:"_getConstraintValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments[1],e=this._getConstraintRowOrColumn(t);return this.meta.contraints[e][n]}},{key:"_getConstraintRowOrColumn",value:function(t){return t?"rows":"columns"}},{key:"getAmountRows",value:function(){return this.meta.amountRows}},{key:"getAmountColumns",value:function(){return this.meta.amountColumns}},{key:"getHighestConstraintValue",value:function(){var t=this.getHighestConstraintForColumnRow(!0),n=this.getHighestConstraintForColumnRow(!1);return t>n?t:n}},{key:"getHighestConstraintForColumnRow",value:function(t){for(var n=this._getAmountRowColumns(t),e=null,o=0;o<n;o++){var i=t?this.getConstraintValueForRow(o):this.getConstraintValueForColumn(o);(null===e||e<i)&&(e=i)}return e}},{key:"print",value:function(){for(var t=this.getAmountRows(),n=this.getAmountColumns(),e=t>n?(t+"").length:(n+"").length,o=(this.getHighestConstraintValue()+"").length,i=e>o?e:o,u="".padStart(i," ")+"|",a=0;a<n;a++)u+=(this.getWeight(a)+"").padStart(i," ")+"|";u+="".padStart(i," ")+"\n";for(var r=0;r<t;r++){u+="".padStart(i,"-")+"+";for(var s=0;s<n;s++)u+="".padStart(i,"-")+"+";u+="".padStart(i,"-")+"\n",u+=(this.getWeight(r)+"").padStart(i," ")+"|";for(var l=0;l<n;l++){u+=(this.getField(r,l).isSolution()?"X":"").padStart(i," ")+"|"}u+=(this.getConstraintValueForRow(r)+"").padStart(i," ")+"\n"}u+="".padStart(i,"-")+"+";for(var m=0;m<n;m++)u+="".padStart(i,"-")+"+";u+="".padStart(i,"-")+"\n",u+="".padStart(i," ")+"|";for(var f=0;f<n;f++)u+=(this.getConstraintValueForColumn(f)+"").padStart(i," ")+"|";return u}}],[{key:"_getFieldKey",value:function(t,n){return t+"-"+n}},{key:"_fieldsAsJSON",value:function(t){for(var n={},e=Object.keys(t),o=0;o<e.length;o++){var i=e[o],u=t[i];n[i]=u.asJSON()}return n}}]),t}(),a=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:0};i(this,t),this.state=n}return o(t,[{key:"setStatus",value:function(t){this.state.status=t}},{key:"isClear",value:function(){return 0===this.state.status}},{key:"isActive",value:function(){return 1===this.state.status}},{key:"isFlagged",value:function(){return 2===this.state.status}},{key:"setReadOnly",value:function(t){t?this.state.readOnly=!0:delete this.state.readOnly}},{key:"isReadOnly",value:function(){return!!this.state.readOnly}},{key:"setIsSolution",value:function(t){this.state.solution=t}},{key:"isSolution",value:function(){return this.state.solution}},{key:"getState",value:function(){return this.state}},{key:"asJSON",value:function(){return this.getState()}}]),t}(),r=function(){function t(){i(this,t)}return o(t,null,[{key:"generateLevel",value:function(n){(n=n||{}).rows=n.rows||5,n.columns=n.columns||n.rows,n.difficulty=n.difficulty||"medium",n.amountMinimumInRow=n.amountMinimumInRow||1,n.amountMaximumInRow=n.amountMaximumInRow||n.rows/2,n.amountMinimumInColumn=n.amountMinimumInColumn||1,n.amountMaximumInColumn=n.amountMaximumInColumn||n.columns/2,n.amountMinimumInRow<0&&(n.amountMinimumInRow=0),n.amountMinimumInRow>n.rows&&(n.amountMinimumInRow=n.rows),n.amountMaximumInRow>n.rows&&(n.amountMaximumInRow=n.rows),n.amountMaximumInRow<0&&(n.amountMaximumInRow=0),n.amountMaximumInRow<n.amountMinimumInRow&&(n.amountMaximumInRow=n.amountMinimumInRow),n.amountMinimumInColumn<0&&(n.amountMinimumInColumn=0),n.amountMinimumInColumn>n.columns&&(n.amountMinimumInColumn=n.columns),n.amountMaximumInColumn>n.columns&&(n.amountMaximumInColumn=n.columns),n.amountMaximumInColumn<0&&(n.amountMaximumInColumn=0),n.amountMaximumInColumn<n.amountMinimumInColumn&&(n.amountMaximumInColumn=n.amountMinimumInColumn);var e=t._initEmptyField(n.rows,n.columns);return e=t._setSolutionFieldsForRowColumn(!0,e,n),e=t._setSolutionFieldsForRowColumn(!1,e,n),u._fieldsAsJSON(e)}},{key:"_setSolutionFieldsForRowColumn",value:function(n,e,o){for(var i=n?o.rows:o.columns,a=0;a<i;a++){var r=[];r=n?t._selectRandomAmountIndexes(o.columns,o.amountMinimumInColumn,o.amountMaximumInColumn):t._selectRandomAmountIndexes(o.rows,o.amountMinimumInRow,o.amountMaximumInRow);for(var s=0;s<r.length;s++){var l=r[s],m=n?a:l,f=n?l:a,v=u._getFieldKey(m,f),h=e[v];h.setIsSolution(!0),e[v]=h}}return e}},{key:"_initEmptyField",value:function(t,n){for(var e={},o=0;o<t;o++)for(var i=o,r=0;r<n;r++){var s=r;e[u._getFieldKey(i,s)]=new a}return e}},{key:"_selectRandomAmountIndexes",value:function(n,e,o){for(var i=t._getRandomInt(e,o),u=Array.from(Array(n).keys()),a=t._shuffle(u),r=[],s=0;s<i;s++)r.push(a[s]);return r}},{key:"_getRandomInt",value:function(t,n){return t=Math.ceil(t),n=Math.floor(n),Math.floor(Math.random()*(n-t+1))+t}},{key:"_shuffle",value:function(t){var n,e,o;for(o=t.length-1;o>0;o--)n=Math.floor(Math.random()*(o+1)),e=t[o],t[o]=t[n],t[n]=e;return t}}]),t}();t.exports.Kakurasu=u,t.exports.KakurasuField=a,t.exports.KakurasuLevelGenerator=r}]);